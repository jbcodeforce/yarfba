<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Jerome Boyer"><link href=../serverless/msk/ rel=prev><link href=../serverless/eventbridge/ rel=next><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.33"><title>Kinesis* - AWS Studies</title><link rel=stylesheet href=../assets/stylesheets/main.3cba04c6.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#kinesis-services class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="AWS Studies" class="md-header__button md-logo" aria-label="AWS Studies" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> AWS Studies </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Kinesis* </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jbcodeforce/yarfba.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="AWS Studies" class="md-nav__button md-logo" aria-label="AWS Studies" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> AWS Studies </label> <div class=md-nav__source> <a href=https://github.com/jbcodeforce/yarfba.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Infrastructure </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Infrastructure </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../infra/ class=md-nav__link> <span class=md-ellipsis> EC2-others </span> </a> </li> <li class=md-nav__item> <a href=../infra/networking/ class=md-nav__link> <span class=md-ellipsis> Networking </span> </a> </li> <li class=md-nav__item> <a href=../infra/security/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> <li class=md-nav__item> <a href=../infra/storage/ class=md-nav__link> <span class=md-ellipsis> S3-Storage </span> </a> </li> <li class=md-nav__item> <a href=../infra/route53/ class=md-nav__link> <span class=md-ellipsis> Route 53 </span> </a> </li> <li class=md-nav__item> <a href=../monitoring/monitoring/ class=md-nav__link> <span class=md-ellipsis> Monitoring </span> </a> </li> <li class=md-nav__item> <a href=../monitoring/cost/ class=md-nav__link> <span class=md-ellipsis> Cost mgt </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Kinesis* </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Kinesis* </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#streaming class=md-nav__link> <span class=md-ellipsis> Streaming </span> </a> </li> <li class=md-nav__item> <a href=#kinesis-basic class=md-nav__link> <span class=md-ellipsis> Kinesis basic </span> </a> <nav class=md-nav aria-label="Kinesis basic"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kinesis-data-streams class=md-nav__link> <span class=md-ellipsis> Kinesis Data Streams </span> </a> </li> <li class=md-nav__item> <a href=#kinesis-data-firehose class=md-nav__link> <span class=md-ellipsis> Kinesis Data Firehose </span> </a> </li> <li class=md-nav__item> <a href=#managed-service-for-apache-flink class=md-nav__link> <span class=md-ellipsis> Managed Service for Apache Flink </span> </a> </li> <li class=md-nav__item> <a href=#when-to-choose-what class=md-nav__link> <span class=md-ellipsis> When to choose what </span> </a> </li> <li class=md-nav__item> <a href=#considerations class=md-nav__link> <span class=md-ellipsis> Considerations </span> </a> </li> <li class=md-nav__item> <a href=#deployment-flink-app-to-managed-service-for-apache-flink class=md-nav__link> <span class=md-ellipsis> Deployment Flink App to Managed Service for Apache Flink </span> </a> </li> <li class=md-nav__item> <a href=#deeper-dive class=md-nav__link> <span class=md-ellipsis> Deeper dive </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../sa/well-architectured/ class=md-nav__link> <span class=md-ellipsis> Well Architectured </span> </a> </li> <li class=md-nav__item> <a href=../sa/sol-design/ class=md-nav__link> <span class=md-ellipsis> Solution design </span> </a> </li> <li class=md-nav__item> <a href=../sa/psa-role/ class=md-nav__link> <span class=md-ellipsis> SA </span> </a> </li> <li class=md-nav__item> <a href=../sa/saas/ class=md-nav__link> <span class=md-ellipsis> SaaS </span> </a> </li> <li class=md-nav__item> <a href=../sa/resiliency/ class=md-nav__link> <span class=md-ellipsis> Resiliency </span> </a> </li> <li class=md-nav__item> <a href=../templ/ class=md-nav__link> <span class=md-ellipsis> Conduct Design session </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Analytics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Analytics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../analytics/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../analytics/emr/ class=md-nav__link> <span class=md-ellipsis> EMR </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Data </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../data/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../data/rds/ class=md-nav__link> <span class=md-ellipsis> RDS-Aurora </span> </a> </li> <li class=md-nav__item> <a href=../data/dynamodb/ class=md-nav__link> <span class=md-ellipsis> DynamoDB </span> </a> </li> <li class=md-nav__item> <a href=../data/data-lake/ class=md-nav__link> <span class=md-ellipsis> Data Lake </span> </a> </li> <li class=md-nav__item> <a href=../data/redshift/ class=md-nav__link> <span class=md-ellipsis> RedShift </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> AI-ML </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> AI-ML </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ai-ml/ class=md-nav__link> <span class=md-ellipsis> All Services </span> </a> </li> <li class=md-nav__item> <a href=../ai-ml/sagemaker/ class=md-nav__link> <span class=md-ellipsis> SageMaker </span> </a> </li> <li class=md-nav__item> <a href=../ai-ml/bedrock/ class=md-nav__link> <span class=md-ellipsis> Bedrock </span> </a> </li> <li class=md-nav__item> <a href=../ai-ml/q/ class=md-nav__link> <span class=md-ellipsis> Amazon Q </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7 checked> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Serverless </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=true> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Serverless </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../serverless/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../serverless/lambda/ class=md-nav__link> <span class=md-ellipsis> Lambda </span> </a> </li> <li class=md-nav__item> <a href=../serverless/apigtw/ class=md-nav__link> <span class=md-ellipsis> API Gateway </span> </a> </li> <li class=md-nav__item> <a href=../serverless/ecs/ class=md-nav__link> <span class=md-ellipsis> ECS </span> </a> </li> <li class=md-nav__item> <a href=../serverless/eks/ class=md-nav__link> <span class=md-ellipsis> EKS </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/aws-messaging-study class=md-nav__link> <span class=md-ellipsis> Messaging </span> </a> </li> <li class=md-nav__item> <a href=../serverless/msk/ class=md-nav__link> <span class=md-ellipsis> MSK </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Kinesis* </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Kinesis* </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#streaming class=md-nav__link> <span class=md-ellipsis> Streaming </span> </a> </li> <li class=md-nav__item> <a href=#kinesis-basic class=md-nav__link> <span class=md-ellipsis> Kinesis basic </span> </a> <nav class=md-nav aria-label="Kinesis basic"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kinesis-data-streams class=md-nav__link> <span class=md-ellipsis> Kinesis Data Streams </span> </a> </li> <li class=md-nav__item> <a href=#kinesis-data-firehose class=md-nav__link> <span class=md-ellipsis> Kinesis Data Firehose </span> </a> </li> <li class=md-nav__item> <a href=#managed-service-for-apache-flink class=md-nav__link> <span class=md-ellipsis> Managed Service for Apache Flink </span> </a> </li> <li class=md-nav__item> <a href=#when-to-choose-what class=md-nav__link> <span class=md-ellipsis> When to choose what </span> </a> </li> <li class=md-nav__item> <a href=#considerations class=md-nav__link> <span class=md-ellipsis> Considerations </span> </a> </li> <li class=md-nav__item> <a href=#deployment-flink-app-to-managed-service-for-apache-flink class=md-nav__link> <span class=md-ellipsis> Deployment Flink App to Managed Service for Apache Flink </span> </a> </li> <li class=md-nav__item> <a href=#deeper-dive class=md-nav__link> <span class=md-ellipsis> Deeper dive </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../serverless/eventbridge/ class=md-nav__link> <span class=md-ellipsis> EventBridge </span> </a> </li> <li class=md-nav__item> <a href=../serverless/stepfct/ class=md-nav__link> <span class=md-ellipsis> Step function </span> </a> </li> <li class=md-nav__item> <a href=../serverless/mwaa/ class=md-nav__link> <span class=md-ellipsis> MWAA </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Playground </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Playground </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../playground/ class=md-nav__link> <span class=md-ellipsis> AWS personal labs </span> </a> </li> <li class=md-nav__item> <a href=../playground/gettingstarted/ class=md-nav__link> <span class=md-ellipsis> Getting Started EC2 </span> </a> </li> <li class=md-nav__item> <a href=../playground/security/ class=md-nav__link> <span class=md-ellipsis> Security-IAM demos </span> </a> </li> <li class=md-nav__item> <a href=../playground/s3-play/ class=md-nav__link> <span class=md-ellipsis> S3 play </span> </a> </li> <li class=md-nav__item> <a href=../playground/networking/ class=md-nav__link> <span class=md-ellipsis> Networking </span> </a> </li> <li class=md-nav__item> <a href=../playground/rds/ class=md-nav__link> <span class=md-ellipsis> RDS </span> </a> </li> <li class=md-nav__item> <a href=../playground/rt-data-processing/ class=md-nav__link> <span class=md-ellipsis> Data processing </span> </a> </li> <li class=md-nav__item> <a href=../playground/spark-emr/ class=md-nav__link> <span class=md-ellipsis> Analytics on EMR </span> </a> </li> <li class=md-nav__item> <a href=../playground/ecs/ class=md-nav__link> <span class=md-ellipsis> ECS </span> </a> </li> <li class=md-nav__item> <a href=../playground/s3-org-billing/ class=md-nav__link> <span class=md-ellipsis> S3 storage lens </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/big-data-tenant-analytics/ class=md-nav__link> <span class=md-ellipsis> SaaS demo </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Coding </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Coding </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../coding/ class=md-nav__link> <span class=md-ellipsis> Practices </span> </a> </li> <li class=md-nav__item> <a href=../coding/sam/ class=md-nav__link> <span class=md-ellipsis> SAM </span> </a> </li> <li class=md-nav__item> <a href=../coding/cloudFormation/ class=md-nav__link> <span class=md-ellipsis> CloudFormation </span> </a> </li> <li class=md-nav__item> <a href=../coding/cdk/ class=md-nav__link> <span class=md-ellipsis> CDK </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io class=md-nav__link> <span class=md-ellipsis> Return to main </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#streaming class=md-nav__link> <span class=md-ellipsis> Streaming </span> </a> </li> <li class=md-nav__item> <a href=#kinesis-basic class=md-nav__link> <span class=md-ellipsis> Kinesis basic </span> </a> <nav class=md-nav aria-label="Kinesis basic"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kinesis-data-streams class=md-nav__link> <span class=md-ellipsis> Kinesis Data Streams </span> </a> </li> <li class=md-nav__item> <a href=#kinesis-data-firehose class=md-nav__link> <span class=md-ellipsis> Kinesis Data Firehose </span> </a> </li> <li class=md-nav__item> <a href=#managed-service-for-apache-flink class=md-nav__link> <span class=md-ellipsis> Managed Service for Apache Flink </span> </a> </li> <li class=md-nav__item> <a href=#when-to-choose-what class=md-nav__link> <span class=md-ellipsis> When to choose what </span> </a> </li> <li class=md-nav__item> <a href=#considerations class=md-nav__link> <span class=md-ellipsis> Considerations </span> </a> </li> <li class=md-nav__item> <a href=#deployment-flink-app-to-managed-service-for-apache-flink class=md-nav__link> <span class=md-ellipsis> Deployment Flink App to Managed Service for Apache Flink </span> </a> </li> <li class=md-nav__item> <a href=#deeper-dive class=md-nav__link> <span class=md-ellipsis> Deeper dive </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=kinesis-services>Kinesis services<a class=headerlink href=#kinesis-services title="Permanent link">&para;</a></h1> <div class="admonition updates"> <p class=admonition-title>Updates</p> <p>Created 12/2022 - Updated 12/04/2023</p> </div> <h2 id=streaming>Streaming<a class=headerlink href=#streaming title="Permanent link">&para;</a></h2> <p>Designed to process real-time streaming data. Streaming means unbounded data sets and continuous arrival. The streaming computation involves processing recent data, with less memory needs compare to big data processing, with low latency.</p> <p>Stream storage uses append-only log semantic. Messages are immutables and could not be deleted in the stream.</p> <h2 id=kinesis-basic>Kinesis basic<a class=headerlink href=#kinesis-basic title="Permanent link">&para;</a></h2> <p><img alt=kin src=diagrams/kinesis.drawio.svg></p> <p>Three main different components are:</p> <ul> <li><strong>Kinesis Streams</strong>: low latency streaming ingest at scale. They offer patterns for data stream processing. It looks similar to Kafka, but MSK is the Kafka deployment.</li> <li><strong>Amazon Managed Service for Apache Flink</strong>: perform real-time analytics on streams using SQL. This Apache Flink as managed service.</li> <li><strong>Kinesis Firehose</strong>: load streams into S3, Redshift, ElasticSearch. No administration, auto scaling, serverless.</li> </ul> <h3 id=kinesis-data-streams><a href=https://docs.aws.amazon.com/streams/latest/dev/introduction.html>Kinesis Data Streams</a><a class=headerlink href=#kinesis-data-streams title="Permanent link">&para;</a></h3> <p>It is a distributed data stream into Shards for parallel processing.</p> <p><img alt src=diagrams/kinesis-data-streams.drawio.png></p> <p>It uses a public endpoint and applications can authenticate using IAM role. Kinesis Data Streams is using a throughput provisioning model, a shard can inject 1 Mb/s or 1000 msg /s with an egress of 2Mb/s. Adding shards help to scale the throughput. A single shard supports up to 5 messages per second, so a unique consumer gets records every 200ms. Adding more consumers on the same shard, the propagation delay increases and throughput per consumer decreases. With 5 consumers, each receives 400kB max every second.</p> <p>Producer sends message with <code>Partition Key</code>. A sequence number is added to the message to note where the message is in the Shard.</p> <ul> <li>Retention from 1 to 365 days.</li> <li>Capable to replay the messages.</li> <li>Immutable records, not deleted by applications.</li> <li>Message in a shard, can share partition key, and keep ordering.</li> <li>It is possible to support exactly-once delivery.</li> <li>Producer can use SDK, or <strong>Kinesis Producer Library</strong> (KPL) or being a Kinesis agent.</li> <li><a href=https://docs.aws.amazon.com/streams/latest/dev/writing-with-agents.html><strong>Kinesis Agent</strong></a> is a stand-alone Java app that offers an easy way to collect and send data to KDS, as it monitors a set of files. It runs on RHEL, or Amazon Linux 2.</li> <li>Consumer may use SDK and <strong>Kinesis Client Library</strong> (KCL), or being one of the managed services like: Lambda, Kinesis Data Firehose, Managed Service for Apache Flink.</li> <li>For consuming side, each Shard gets 2MB/s out.</li> <li>If consumer fails on one record in a batch, the entire batch (and thus the shard) is blocked until either the message processes successfully or the retention period for the data records in the batch expires.</li> <li>It uses enhanced fan-out if we have multiple consumers retrieving data from a stream in parallel. This throughput automatically scales with the number of shards in a stream.</li> <li>Pricing is per Shard provisioned per hour.</li> <li>The capacity limits of a Kinesis data stream are defined by the number of shards within the data stream. The limits can be exceeded by either data throughput or the number of reading data calls. Each shard allows for 1 MB/s incoming data and 2 MB/s outgoing data. We should increase the number of shards within our data stream to provide enough capacity.</li> </ul> <p>There is an On-demand mode, pay as we go, with a default capacity of 4MB/s or 4000mg/s. Pricing per stream, per hour and data in/out per GB.</p> <p>Captured Metrics are:</p> <ul> <li>number of incoming/outgoing bytes,</li> <li>number incoming/outgoing records,</li> <li>Write / read provisioned throughput exceeded,</li> <li>iterator age ms.</li> </ul> <h4 id=deployment>Deployment<a class=headerlink href=#deployment title="Permanent link">&para;</a></h4> <p>Using CDK, see example in <a href=https://github.com/jbcodeforce/big-data-tenant-analytics/tree/main/cdk/kinesis>cdk/kinesis</a>, but can be summarized as:</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>aws_cdk</span> <span class=kn>import</span> <span class=p>(</span>
    <span class=n>aws_kinesis</span> <span class=k>as</span> <span class=n>kinesis</span>
<span class=p>)</span>

<span class=n>kinesis</span><span class=o>.</span><span class=n>Stream</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s2>&quot;SaaSdemoStream&quot;</span><span class=p>,</span>
    <span class=n>stream_name</span><span class=o>=</span><span class=s2>&quot;bg-jobs&quot;</span><span class=p>,</span>
    <span class=n>shard_count</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
    <span class=n>retention_period</span><span class=o>=</span><span class=n>Duration</span><span class=o>.</span><span class=n>hours</span><span class=p>(</span><span class=mi>24</span><span class=p>)</span>
<span class=p>)</span>
</code></pre></div> <p>Using CLI:</p> <div class=highlight><pre><span></span><code>aws<span class=w> </span>kinesis<span class=w> </span>create-stream<span class=w> </span>--stream-name<span class=w> </span>ExampleInputStream<span class=w> </span>--shard-count<span class=w> </span><span class=m>1</span><span class=w> </span>--region<span class=w> </span>us-west-2<span class=w> </span>--profile<span class=w> </span>adminuser
</code></pre></div> <h4 id=producer>Producer<a class=headerlink href=#producer title="Permanent link">&para;</a></h4> <p>Producer applications are done using Kinesis Producer Library (KPL) and they can batch events, and perform retries. Internally KPL uses queue to bufferize messages. Example of python code using boto3 and KPL:</p> <div class=highlight><pre><span></span><code><span class=n>STREAM_NAME</span> <span class=o>=</span> <span class=s2>&quot;companies&quot;</span>
<span class=n>my_session</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
<span class=n>my_region</span> <span class=o>=</span> <span class=n>my_session</span><span class=o>.</span><span class=n>region_name</span>
<span class=n>kinesis_client</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s1>&#39;kinesis&#39;</span><span class=p>,</span><span class=n>region_name</span><span class=o>=</span><span class=n>my_region</span><span class=p>)</span>

<span class=k>def</span> <span class=nf>sendCompanyJson</span><span class=p>():</span>
    <span class=n>company</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;companyID&quot;</span> <span class=p>:</span> <span class=s2>&quot;comp_4&quot;</span><span class=p>,</span>
            <span class=s2>&quot;industry&quot;</span><span class=p>:</span> <span class=s2>&quot;retail&quot;</span><span class=p>,</span>
            <span class=s2>&quot;revenu&quot;</span><span class=p>:</span> <span class=mi>29080</span><span class=p>,</span>
            <span class=s2>&quot;employees&quot;</span><span class=p>:</span> <span class=mi>14540</span><span class=p>,</span>
            <span class=s2>&quot;job30&quot;</span><span class=p>:</span> <span class=mi>4</span><span class=p>,</span>
            <span class=s2>&quot;job90&quot;</span><span class=p>:</span><span class=mi>13</span><span class=p>,</span>
            <span class=s2>&quot;monthlyFee&quot;</span><span class=p>:</span> <span class=mf>460.00</span><span class=p>,</span>
            <span class=s2>&quot;totalFee&quot;</span><span class=p>:</span> <span class=mf>1172.00</span>
    <span class=p>}</span>
    <span class=n>companyAsString</span> <span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>company</span><span class=p>)</span>
    <span class=n>kinesis_client</span><span class=o>.</span><span class=n>put_record</span><span class=p>(</span>
                <span class=n>StreamName</span><span class=o>=</span><span class=n>STREAM_NAME</span><span class=p>,</span>
                <span class=n>Data</span><span class=o>=</span><span class=n>companyAsString</span><span class=p>,</span>
                <span class=n>PartitionKey</span><span class=o>=</span><span class=s2>&quot;partitionkey&quot;</span><span class=p>)</span>
</code></pre></div> <h4 id=aws-cli>AWS CLI<a class=headerlink href=#aws-cli title="Permanent link">&para;</a></h4> <p>Produce:</p> <div class=highlight><pre><span></span><code>aws<span class=w> </span>kinesis<span class=w> </span>put-record<span class=w> </span>--stream-name<span class=w> </span><span class=nb>test</span><span class=w> </span>--partition-key<span class=w> </span>user1<span class=w> </span>--data<span class=w> </span><span class=s2>&quot;user signup&quot;</span><span class=w> </span>--cli-binary-format<span class=w> </span>raw-in-base64-out
</code></pre></div> <h4 id=consumer>Consumer<a class=headerlink href=#consumer title="Permanent link">&para;</a></h4> <h4 id=aws-sdk>AWS SDK<a class=headerlink href=#aws-sdk title="Permanent link">&para;</a></h4> <details class=warning> <summary>Warning</summary> <p>To be done </p> </details> <h4 id=aws-cli_1>AWS CLI<a class=headerlink href=#aws-cli_1 title="Permanent link">&para;</a></h4> <p>Consume:</p> <div class=highlight><pre><span></span><code><span class=c1># Describe the stream</span>
aws<span class=w> </span>kinesis<span class=w> </span>describe-stream<span class=w> </span>--stream-name<span class=w> </span><span class=nb>test</span>
<span class=c1># Get some data</span>
aws<span class=w> </span>kinesis<span class=w> </span>get-shard-iterator<span class=w> </span>--stream-name<span class=w> </span><span class=nb>test</span><span class=w> </span>--shard-id<span class=w> </span>shardId--00000000<span class=w> </span>--shard-iterator-type<span class=w> </span>TRIM_HORIZON
<span class=c1># The returned message gave the next message iterator that should be used in the next call.</span>
aws<span class=w> </span>kinesis<span class=w> </span>get-records<span class=w> </span>--shard-iterator<span class=w> </span>&lt;the-iterator-id&gt;
</code></pre></div> <h3 id=kinesis-data-firehose><a href=https://docs.aws.amazon.com/firehose/latest/dev/what-is-this-service.html>Kinesis Data Firehose</a><a class=headerlink href=#kinesis-data-firehose title="Permanent link">&para;</a></h3> <p>Firehose is a fully managed service for delivering real-time streaming data to various supported destinations.</p> <p><img alt src=diagrams/firehose.drawio.svg></p> <ul> <li>Firehose buffers incoming streaming data to a certain size (MBs) or for a certain period of time (in s) before delivering it to destinations.</li> <li>We create <strong>delivery stream</strong>, for sources that are most of the time logs from the different AWS services. Transformations are done in Lambda function.</li> <li>It is tuned to stream to the target destination, as simpler to configure than doing custom solution on top of Kinesis Data Streams or MSK.</li> <li>Data Firehose does not guarantee order delivery and exactly once semantic.</li> <li>It can delegates the record transformation processing to a custom Lambda function, but it supports different format already. It tries the invocation 3 times and then skips the batch of records. Records that failed to process are delivered to an Amazon S3 bucket in a processing_failed folder.</li> <li>It outputs batch files to the target destinations. Batch is based on 60s (or more) window or 1 MB of data. Therefore it is a near real-time service.</li> <li>As a managed services it also supports auto scaling. The number of shards is managed by the service based on data volume.</li> <li>IAM role needs to be referenced to write to S3.</li> <li>Firehose uses S3 to backup all or failed only data that it attempts to deliver to the chosen destination.</li> <li>Use an <em>interface VPC endpoint</em> to keep traffic between our VPC and Kinesis Data Firehose from leaving the Amazon network.</li> </ul> <h3 id=managed-service-for-apache-flink><a href=https://docs.aws.amazon.com/managed-flink/latest/java/what-is.html>Managed Service for Apache Flink</a><a class=headerlink href=#managed-service-for-apache-flink title="Permanent link">&para;</a></h3> <p>This is a managed service to transform and analyze streaming data in real time using Apache Flink. It can consume records from different sources, and in this demonstration we use Kinesis Data Streams.</p> <p><img alt src=https://d1.awsstatic.com/amazon-managed-service-for-apache-flink/Product-Page-Diagram_Amazon-Managed-Service-for-Apache-Flink_V2%402x.05921e8cff707ccc2f80514872e25bb7ea3e02d7.png></p> <p>The underlying architecture consists of a <strong>Job Manager</strong> and n <strong>Task Managers</strong>.</p> <ul> <li>The <strong>JobManager</strong> controls the execution of a single application. It receives an application for execution and builds a Task Execution Graph from the defined Job Graph. It manages job submission and the job lifecycle then allocates work to Task Managers</li> <li>The <strong>Resource Manager</strong> manages Task Slots and leverages underlying orchestrator, like Kubernetes or Yarn.</li> <li>A <strong>Task slot</strong> is the unit of work executed on CPU.</li> <li>The <strong>Task Managers</strong> execute the actual stream processing logic. There are multiple task managers running in a cluster. </li> </ul> <p>The number of slots limits the number of tasks a TaskManager can execute. After it has been started, a TaskManager registers its slots to the ResourceManager</p> <p><img alt src=diagrams/flink-arch.drawio.svg></p> <p><a href=https://jbcodeforce.github.io/flink-studies/ >See my Flink studies</a></p> <h3 id=when-to-choose-what>When to choose what<a class=headerlink href=#when-to-choose-what title="Permanent link">&para;</a></h3> <p>As Apache Flink is an open-source project, it is possible to deploy it in a Kubernetes cluster, using Flink operator. This will bring us with the most flexible solution as we can select the underlying EC2 instances needed, to optimize our cost. Also we will have fine-grained control over cluster settings, debugging tools and monitoring.</p> <p>While Managed Service for Apache Flink helps us to focus on the application logic, which is not simple programming experience, as stateful processing is challenging, there is no management of infrastructure, monitoring, auto scaling and high availability integrated in the service.</p> <p>In addition to the AWS integrations, the Managed Service for Apache Flink libraries include more than 10 Apache Flink connectors and the ability to build custom integrations.</p> <h3 id=considerations>Considerations<a class=headerlink href=#considerations title="Permanent link">&para;</a></h3> <p>When connecting to Managed Service for Apache Flink, we need to consider the number of shards and the constraint on the throughput to design the Flink application to avoid getting throttled. As introduced previously, with one Flink Application, we may need to pause around 200ms before doing the next GetRecords.</p> <h3 id=deployment-flink-app-to-managed-service-for-apache-flink>Deployment Flink App to Managed Service for Apache Flink<a class=headerlink href=#deployment-flink-app-to-managed-service-for-apache-flink title="Permanent link">&para;</a></h3> <details class=warning> <summary>Warning</summary> <p>To be done</p> </details> <h3 id=deeper-dive>Deeper dive<a class=headerlink href=#deeper-dive title="Permanent link">&para;</a></h3> <ul> <li><a href=https://docs.aws.amazon.com/kinesisanalytics/latest/dev/examples.html>Amazon Kinesis Data Analytics for SQL Applications Developer Guide</a></li> <li><a href=https://docs.aws.amazon.com/kinesisanalytics/latest/java/get-started-exercise.html#get-started-exercise-7-cli>Getting started</a> with example on how to create application with CLI.</li> <li><a href=https://jaehyeon.me/blog/2023-09-14-fraud-detection-part-2/ >AWS Kafka and DynamoDB for real time fraud detection</a></li> <li><a href=https://catalog.us-east-1.prod.workshops.aws/workshops/2300137e-f2ac-4eb9-a4ac-3d25026b235f/en-US>Real Time Streaming with Amazon Kinesis</a></li> <li><a href=https://dev.solita.fi/2020/05/28/kinesis-streams-part-1.html>Mastering AWS Kinesis Data Streams, Part 1</a> very good article to keep in bookmark. </li> <li><a href=https://dev.solita.fi/2020/12/21/kinesis-streams-part-2.html>Mastering AWS Kinesis Data Streams, Part 2</a> consumer side of the story.</li> </ul> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../serverless/msk/ class="md-footer__link md-footer__link--prev" aria-label="Previous: MSK"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> MSK </div> </div> </a> <a href=../serverless/eventbridge/ class="md-footer__link md-footer__link--next" aria-label="Next: EventBridge"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> EventBridge </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "navigation.instant", "navigation.tracking", "navigation.footer", "navigation.tabs.sticky"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.af256bd8.min.js></script> </body> </html>