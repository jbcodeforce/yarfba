<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Jerome Boyer"><link href=../spark-emr/ rel=prev><link href=../s3-org-billing/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.33"><title>ECS - AWS Studies</title><link rel=stylesheet href=../../assets/stylesheets/main.3cba04c6.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#ecs-playgrounds class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="AWS Studies" class="md-header__button md-logo" aria-label="AWS Studies" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> AWS Studies </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> ECS </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jbcodeforce/yarfba.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="AWS Studies" class="md-nav__button md-logo" aria-label="AWS Studies" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> AWS Studies </label> <div class=md-nav__source> <a href=https://github.com/jbcodeforce/yarfba.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Infrastructure </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Infrastructure </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../infra/ class=md-nav__link> <span class=md-ellipsis> EC2-others </span> </a> </li> <li class=md-nav__item> <a href=../../infra/networking/ class=md-nav__link> <span class=md-ellipsis> Networking </span> </a> </li> <li class=md-nav__item> <a href=../../infra/security/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> <li class=md-nav__item> <a href=../../infra/storage/ class=md-nav__link> <span class=md-ellipsis> S3-Storage </span> </a> </li> <li class=md-nav__item> <a href=../../infra/route53/ class=md-nav__link> <span class=md-ellipsis> Route 53 </span> </a> </li> <li class=md-nav__item> <a href=../../monitoring/monitoring/ class=md-nav__link> <span class=md-ellipsis> Monitoring </span> </a> </li> <li class=md-nav__item> <a href=../../monitoring/cost/ class=md-nav__link> <span class=md-ellipsis> Cost mgt </span> </a> </li> <li class=md-nav__item> <a href=../../kinesis/ class=md-nav__link> <span class=md-ellipsis> Kinesis* </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../sa/well-architectured/ class=md-nav__link> <span class=md-ellipsis> Well Architectured </span> </a> </li> <li class=md-nav__item> <a href=../../sa/sol-design/ class=md-nav__link> <span class=md-ellipsis> Solution design </span> </a> </li> <li class=md-nav__item> <a href=../../sa/psa-role/ class=md-nav__link> <span class=md-ellipsis> SA </span> </a> </li> <li class=md-nav__item> <a href=../../sa/saas/ class=md-nav__link> <span class=md-ellipsis> SaaS </span> </a> </li> <li class=md-nav__item> <a href=../../sa/resiliency/ class=md-nav__link> <span class=md-ellipsis> Resiliency </span> </a> </li> <li class=md-nav__item> <a href=../../templ/ class=md-nav__link> <span class=md-ellipsis> Conduct Design session </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Analytics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Analytics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../analytics/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../analytics/emr/ class=md-nav__link> <span class=md-ellipsis> EMR </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Data </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../data/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../data/rds/ class=md-nav__link> <span class=md-ellipsis> RDS-Aurora </span> </a> </li> <li class=md-nav__item> <a href=../../data/dynamodb/ class=md-nav__link> <span class=md-ellipsis> DynamoDB </span> </a> </li> <li class=md-nav__item> <a href=../../data/data-lake/ class=md-nav__link> <span class=md-ellipsis> Data Lake </span> </a> </li> <li class=md-nav__item> <a href=../../data/redshift/ class=md-nav__link> <span class=md-ellipsis> RedShift </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> AI-ML </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> AI-ML </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ai-ml/ class=md-nav__link> <span class=md-ellipsis> All Services </span> </a> </li> <li class=md-nav__item> <a href=../../ai-ml/sagemaker/ class=md-nav__link> <span class=md-ellipsis> SageMaker </span> </a> </li> <li class=md-nav__item> <a href=../../ai-ml/bedrock/ class=md-nav__link> <span class=md-ellipsis> Bedrock </span> </a> </li> <li class=md-nav__item> <a href=../../ai-ml/q/ class=md-nav__link> <span class=md-ellipsis> Amazon Q </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Serverless </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Serverless </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../serverless/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/lambda/ class=md-nav__link> <span class=md-ellipsis> Lambda </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/apigtw/ class=md-nav__link> <span class=md-ellipsis> API Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/ecs/ class=md-nav__link> <span class=md-ellipsis> ECS </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/eks/ class=md-nav__link> <span class=md-ellipsis> EKS </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/aws-messaging-study class=md-nav__link> <span class=md-ellipsis> Messaging </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/msk/ class=md-nav__link> <span class=md-ellipsis> MSK </span> </a> </li> <li class=md-nav__item> <a href=../../kinesis/ class=md-nav__link> <span class=md-ellipsis> Kinesis* </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/eventbridge/ class=md-nav__link> <span class=md-ellipsis> EventBridge </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/stepfct/ class=md-nav__link> <span class=md-ellipsis> Step function </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/mwaa/ class=md-nav__link> <span class=md-ellipsis> MWAA </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8 checked> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Playground </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=true> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Playground </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> <span class=md-ellipsis> AWS personal labs </span> </a> </li> <li class=md-nav__item> <a href=../gettingstarted/ class=md-nav__link> <span class=md-ellipsis> Getting Started EC2 </span> </a> </li> <li class=md-nav__item> <a href=../security/ class=md-nav__link> <span class=md-ellipsis> Security-IAM demos </span> </a> </li> <li class=md-nav__item> <a href=../s3-play/ class=md-nav__link> <span class=md-ellipsis> S3 play </span> </a> </li> <li class=md-nav__item> <a href=../networking/ class=md-nav__link> <span class=md-ellipsis> Networking </span> </a> </li> <li class=md-nav__item> <a href=../rds/ class=md-nav__link> <span class=md-ellipsis> RDS </span> </a> </li> <li class=md-nav__item> <a href=../rt-data-processing/ class=md-nav__link> <span class=md-ellipsis> Data processing </span> </a> </li> <li class=md-nav__item> <a href=../spark-emr/ class=md-nav__link> <span class=md-ellipsis> Analytics on EMR </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> ECS </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> ECS </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#deploy-nginx-docker-image-on-fargate class=md-nav__link> <span class=md-ellipsis> Deploy NGinx docker image on Fargate </span> </a> </li> <li class=md-nav__item> <a href=#deploy-a-python-flask-app-using-aws-console-on-ecs-fargate class=md-nav__link> <span class=md-ellipsis> Deploy a Python Flask app using AWS Console on ECS Fargate </span> </a> <nav class=md-nav aria-label="Deploy a Python Flask app using AWS Console on ECS Fargate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-connect-to-an-amazon-ecs-container-using-aws-ecs-execute-command class=md-nav__link> <span class=md-ellipsis> How to connect to an Amazon ECS container using AWS ECS execute command </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#deploy-a-python-flask-app-with-cdk-ecs_patterns class=md-nav__link> <span class=md-ellipsis> Deploy a Python Flask app with CDK ecs_patterns </span> </a> </li> <li class=md-nav__item> <a href=#deploying-quarkus-app-with-cdk class=md-nav__link> <span class=md-ellipsis> Deploying Quarkus App with CDK </span> </a> </li> <li class=md-nav__item> <a href=#some-how-tos class=md-nav__link> <span class=md-ellipsis> Some how-tos </span> </a> </li> <li class=md-nav__item> <a href=#other-examples class=md-nav__link> <span class=md-ellipsis> Other examples </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../s3-org-billing/ class=md-nav__link> <span class=md-ellipsis> S3 storage lens </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/big-data-tenant-analytics/ class=md-nav__link> <span class=md-ellipsis> SaaS demo </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Coding </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Coding </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../coding/ class=md-nav__link> <span class=md-ellipsis> Practices </span> </a> </li> <li class=md-nav__item> <a href=../../coding/sam/ class=md-nav__link> <span class=md-ellipsis> SAM </span> </a> </li> <li class=md-nav__item> <a href=../../coding/cloudFormation/ class=md-nav__link> <span class=md-ellipsis> CloudFormation </span> </a> </li> <li class=md-nav__item> <a href=../../coding/cdk/ class=md-nav__link> <span class=md-ellipsis> CDK </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io class=md-nav__link> <span class=md-ellipsis> Return to main </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#deploy-nginx-docker-image-on-fargate class=md-nav__link> <span class=md-ellipsis> Deploy NGinx docker image on Fargate </span> </a> </li> <li class=md-nav__item> <a href=#deploy-a-python-flask-app-using-aws-console-on-ecs-fargate class=md-nav__link> <span class=md-ellipsis> Deploy a Python Flask app using AWS Console on ECS Fargate </span> </a> <nav class=md-nav aria-label="Deploy a Python Flask app using AWS Console on ECS Fargate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-connect-to-an-amazon-ecs-container-using-aws-ecs-execute-command class=md-nav__link> <span class=md-ellipsis> How to connect to an Amazon ECS container using AWS ECS execute command </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#deploy-a-python-flask-app-with-cdk-ecs_patterns class=md-nav__link> <span class=md-ellipsis> Deploy a Python Flask app with CDK ecs_patterns </span> </a> </li> <li class=md-nav__item> <a href=#deploying-quarkus-app-with-cdk class=md-nav__link> <span class=md-ellipsis> Deploying Quarkus App with CDK </span> </a> </li> <li class=md-nav__item> <a href=#some-how-tos class=md-nav__link> <span class=md-ellipsis> Some how-tos </span> </a> </li> <li class=md-nav__item> <a href=#other-examples class=md-nav__link> <span class=md-ellipsis> Other examples </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=ecs-playgrounds>ECS playgrounds<a class=headerlink href=#ecs-playgrounds title="Permanent link">&para;</a></h1> <p>Different examples of how to deploy apps on ECS cluster.</p> <p>See also <a href=../../serverless/ecs/ >ECS service summary</a>.</p> <h2 id=deploy-nginx-docker-image-on-fargate>Deploy NGinx docker image on Fargate<a class=headerlink href=#deploy-nginx-docker-image-on-fargate title="Permanent link">&para;</a></h2> <p>This is using the AWS Console.</p> <ol> <li> <p>Create an ECS cluster, using Fargate runtime, and CloudWatch container insights.</p> <p><img alt src=../images/ecs/ecs-cluster.png></p> <p>As an alternate approach, use aws CLI or CDK/cloudformation as illustrated <a href=#deploy-a-python-flask-app-with-cdk-ecs_patterns>below</a>.</p> </li> <li> <p>Ensure the VPC in which the ECS cluster is deployed, has a route to access to the port number of the app to deploy (port 8080 or 80) </p> </li> <li> <p>Add a task definition to use NGInx demo hello docker image</p> <p><img alt src=../images/ecs/ecs-task-0.png width=700></p> <p>There is no need to specify environment variables in this demonstration.</p> <p>Specify the environment like EC2 or Fargate and then the CPU requirements.</p> <p>There is not need to add a <code>Task role</code> as the container is not accessing any AWS service via API (if not, specify a IAM role which has the necessary policies). No Storage needed neither.</p> <p>Enable <code>log collection</code> to CloudWatch, but no need to send trace to AWS X-Ray and metrics to AWS Distro.</p> <p><img alt src=../images/ecs/ecs-task-2.png width=700></p> </li> <li> <p>A web app may need to scale horizontally, and in this case we need to create a service to expose it: Select the ECS cluster as target environment:</p> <p><img alt src=../../serverless/images/ecs/ecs-service-1.png width=700></p> <p>Then specify that the service will use more than one replica:</p> <p><img alt src=../images/ecs/ecs-service-2.png width=700></p> <p>The deployment parameters control the % allocated during deployment:</p> <p><img alt src=../images/ecs/ecs-service-3.png width=700></p> <p>Be sure to select the VPC where the ECS cluster is defined then the subnets, and a specific security group granting access on port 80 coming from the ALB security group:</p> <p><img alt src=../images/ecs/ecs-service-4.png width=700></p> <p>As we want to facade with an ALB, we do not want to setup a public IP address with a ENI. </p> <p><img alt src=../images/ecs/ecs-service-5.png width=700></p> </li> <li> <p>Get DNS name of the ALB or the IP address</p> <ul> <li>If we created a public IP address then an ENI was created, and going to the ENI definition will let access to the DNS name, something like: <code>ec2-34-216-228-13.us-west-2.compute.amazonaws.com</code> </li> </ul> </li> </ol> <h2 id=deploy-a-python-flask-app-using-aws-console-on-ecs-fargate>Deploy a Python Flask app using AWS Console on ECS Fargate<a class=headerlink href=#deploy-a-python-flask-app-using-aws-console-on-ecs-fargate title="Permanent link">&para;</a></h2> <ol> <li>Create a ECS cluster if not done already.</li> <li> <p>Build the docker image for the Flask App. If build on MAC M1|M2 CPU, use the platform parameter.</p> <div class=highlight><pre><span></span><code>docker<span class=w> </span>build<span class=w> </span>--platform<span class=w> </span>linux/amd64<span class=w> </span>-t<span class=w> </span>j9r_flaskapp<span class=w> </span>.<span class=w> </span>
</code></pre></div> </li> <li> <p>Upload the image to ECR repository (see <a href=../gettingstarted/#ecr-for-container-registry>commands here</a>): be sure to match repository name with the docker image name</p> <p><img alt src=../images/ecs/uploaded-image.png></p> </li> <li> <p>Create a task definition, mostly the same as in previous example, the image reference is the one in the private registry in the same AWS Account. Be sure to select a Task execution role with the <code>AmazonECSTaskExecutionRolePolicy</code> managed policies attached to it:</p> <p><img alt src=../images/ecs/pyth-task-def.png></p> <details class="- info"> <summary>Task role vs execution task role</summary> <p><em>ECS task roles</em> allow the containers in the task to assume an IAM role to call AWS APIs without having to use AWS Credentials inside the containers. The trusted principals in the role is the <code>ecs-tasks.amazonaws.com</code> service. <em>ECS task execution roles</em> grant the ECS agents permission to make AWS API calls who are responsible for managing the tasks in the cluster.</p> </details> </li> <li> <p>As the task should run as a web application, we need to create a service from the task definition detail panel. Choose Capacity provider strategy for the computation deployment configuration, then <code>Replica</code> and one desired task, select the Default VPC and one or 2 subnets. Select an existing Security Group is the matching port is already expose (port http 80). No need to create an ALB for this deployment. Defining a service, builds a cloud formation template. After few minutes the service and task are running. The URL is the public IP address for the task. </p> <p><img alt src=../images/ecs/serv-running.png></p> </li> <li> <p>Update the security group if needed to get HTTP port 80 open. Use the URL.</p> </li> <li>Stop the service.</li> </ol> <h3 id=how-to-connect-to-an-amazon-ecs-container-using-aws-ecs-execute-command>How to connect to an Amazon ECS container using AWS ECS execute command<a class=headerlink href=#how-to-connect-to-an-amazon-ecs-container-using-aws-ecs-execute-command title="Permanent link">&para;</a></h3> <p>It is possible to use tool like <a href=https://github.com/aws-containers/amazon-ecs-exec-checker>ecs-exec-checker</a> to remote connect to a container started as a task in ECS.</p> <h2 id=deploy-a-python-flask-app-with-cdk-ecs_patterns>Deploy a Python Flask app with CDK ecs_patterns<a class=headerlink href=#deploy-a-python-flask-app-with-cdk-ecs_patterns title="Permanent link">&para;</a></h2> <p>See the <a href=https://github.com/jbcodeforce/yarfba/tree/main/labs/cdk/ecs-fargate-flask>folder: labs/cdk/ecs-fargate</a> with a ECS cluster in the Default VPC, a Python flask application build and pushed to ECR in private repository. Below is the extract from the stack definition:</p> <div class=highlight><pre><span></span><code>    <span class=n>vpc</span> <span class=o>=</span> <span class=n>ec2</span><span class=o>.</span><span class=n>Vpc</span><span class=o>.</span><span class=n>from_lookup</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s2>&quot;lookup&quot;</span><span class=p>,</span> <span class=n>is_default</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>     <span class=c1># default is all AZs in region</span>

    <span class=n>cluster</span> <span class=o>=</span> <span class=n>ecs</span><span class=o>.</span><span class=n>Cluster</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s2>&quot;MyCluster&quot;</span><span class=p>,</span> <span class=n>vpc</span><span class=o>=</span><span class=n>vpc</span><span class=p>)</span>

    <span class=n>ecs_patterns</span><span class=o>.</span><span class=n>ApplicationLoadBalancedFargateService</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s2>&quot;MyFargateService&quot;</span><span class=p>,</span>
        <span class=n>cluster</span><span class=o>=</span><span class=n>cluster</span><span class=p>,</span>            <span class=c1># Required</span>
        <span class=n>cpu</span><span class=o>=</span><span class=mi>256</span><span class=p>,</span>                    <span class=c1># Default is 256</span>
        <span class=n>desired_count</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>            <span class=c1># Default is 1</span>
        <span class=n>task_image_options</span><span class=o>=</span><span class=n>ecs_patterns</span><span class=o>.</span><span class=n>ApplicationLoadBalancedTaskImageOptions</span><span class=p>(</span>
            <span class=n>image</span><span class=o>=</span><span class=n>ecs</span><span class=o>.</span><span class=n>ContainerImage</span><span class=o>.</span><span class=n>from_asset</span><span class=p>(</span><span class=s2>&quot;./server&quot;</span><span class=p>)),</span>
        <span class=n>memory_limit_mib</span><span class=o>=</span><span class=mi>512</span><span class=p>,</span>      <span class=c1># Default is 512</span>
        <span class=n>public_load_balancer</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <ul> <li> <p>Cluster created with the name of the stack:</p> <p><img alt src=../images/ecs/created-cluster.png></p> </li> <li> <p>ALB: As the CDK code used the <a href>ecs.patterns</a> with an ALB, we can see the ALB declaration in AWS console. The target group being the ECS service. There is also a DNS A record created, and using the DNS URL should bring the Flask app hello world message.</p> <p><img alt src=../images/ecs/alb-for-ecs-service.png></p> </li> <li> <p>The target group</p> </li> <li> <p>ECS Service </p> <p><img alt src=../images/ecs/flask-service.png></p> </li> <li> <p>ECS Task Definition illustrates the two IAM roles created: 1/ to get ECS principals being able to call ECR, and writing to logs, and 2/ an execution role to write logs</p> <p><img alt src=../images/ecs/flask-task.png></p> </li> </ul> <details class="- info"> <summary>Networking topology change on Fargate 1.4.0+</summary> <p>There is only one ENI now per task. All traffic stays inside of our VPC, even the Fargate platform traffic, like accessing ECR and Secret Manager. To be able for the task to access ECR private registry, Secret Manager... we need to add a privatelink to those services. </p> </details> <h2 id=deploying-quarkus-app-with-cdk>Deploying Quarkus App with CDK<a class=headerlink href=#deploying-quarkus-app-with-cdk title="Permanent link">&para;</a></h2> <p>See <a href=https://github.com/jbcodeforce/aws-cdk-project-templates>this aws-cdk-project-templates repository</a> for a project template.</p> <ol> <li> <p>Create a CDK app, define a VPC, public, private subnets and routing inbound rule on the same port as the exposed port of the app (80 or 8080) in its security group, and add ECS cluster construct to the stack: The code below use a config dict to share some configuration values.</p> <div class=highlight><pre><span></span><code> <span class=bp>self</span><span class=o>.</span><span class=n>ecs_cluster</span><span class=p>:</span> <span class=n>ecs</span><span class=o>.</span><span class=n>Cluster</span> <span class=o>=</span> <span class=n>ecs</span><span class=o>.</span><span class=n>Cluster</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=s2>&quot;ECSCluster&quot;</span><span class=p>,</span> 
        <span class=n>vpc</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>vpc</span><span class=p>,</span> 
        <span class=n>cluster_name</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;ecs_cluster_name&quot;</span><span class=p>)</span>
    <span class=p>)</span>
</code></pre></div> </li> <li> <p>Define an IAM role to let the application accessing other AWS Service, with the secure policies attached to it</p> </li> <li>Add a task definition</li> <li>Add a load balancer</li> </ol> <h2 id=some-how-tos>Some how-tos<a class=headerlink href=#some-how-tos title="Permanent link">&para;</a></h2> <details class="- info"> <summary>Deactivate a task</summary> <p>Select the task definition name to open a second panel with <code>Deregister</code> action.</p> </details> <details class="- info"> <summary>Delete task definition</summary> <p>A task definition deletion request will not complete if there are any Amazon ECS resources that depend on the task definition revision. Select the task definition name, and in the second panel the delete option.</p> </details> <h2 id=other-examples>Other examples<a class=headerlink href=#other-examples title="Permanent link">&para;</a></h2> <ul> <li><a href=https://awstip.com/deploying-a-container-image-with-a-quarkus-native-application-on-aws-fargate-ecs-b09141fe7ff4>Deploying Quarkus native app with Postgresql Aurora</a></li> </ul> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../spark-emr/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Analytics on EMR"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Analytics on EMR </div> </div> </a> <a href=../s3-org-billing/ class="md-footer__link md-footer__link--next" aria-label="Next: S3 storage lens"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> S3 storage lens </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "navigation.instant", "navigation.tracking", "navigation.footer", "navigation.tabs.sticky"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.af256bd8.min.js></script> </body> </html>