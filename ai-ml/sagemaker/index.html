<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Jerome Boyer"><link href=../ rel=prev><link href=../bedrock/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.33"><title>SageMaker - AWS Studies</title><link rel=stylesheet href=../../assets/stylesheets/main.3cba04c6.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#amazon-sagemaker class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="AWS Studies" class="md-header__button md-logo" aria-label="AWS Studies" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> AWS Studies </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> SageMaker </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jbcodeforce/yarfba.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="AWS Studies" class="md-nav__button md-logo" aria-label="AWS Studies" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> AWS Studies </label> <div class=md-nav__source> <a href=https://github.com/jbcodeforce/yarfba.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Infrastructure </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Infrastructure </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../infra/ class=md-nav__link> <span class=md-ellipsis> EC2-others </span> </a> </li> <li class=md-nav__item> <a href=../../infra/networking/ class=md-nav__link> <span class=md-ellipsis> Networking </span> </a> </li> <li class=md-nav__item> <a href=../../infra/security/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> <li class=md-nav__item> <a href=../../infra/storage/ class=md-nav__link> <span class=md-ellipsis> S3-Storage </span> </a> </li> <li class=md-nav__item> <a href=../../infra/route53/ class=md-nav__link> <span class=md-ellipsis> Route 53 </span> </a> </li> <li class=md-nav__item> <a href=../../monitoring/monitoring/ class=md-nav__link> <span class=md-ellipsis> Monitoring </span> </a> </li> <li class=md-nav__item> <a href=../../monitoring/cost/ class=md-nav__link> <span class=md-ellipsis> Cost mgt </span> </a> </li> <li class=md-nav__item> <a href=../../kinesis/ class=md-nav__link> <span class=md-ellipsis> Kinesis* </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../sa/well-architectured/ class=md-nav__link> <span class=md-ellipsis> Well Architectured </span> </a> </li> <li class=md-nav__item> <a href=../../sa/sol-design/ class=md-nav__link> <span class=md-ellipsis> Solution design </span> </a> </li> <li class=md-nav__item> <a href=../../sa/psa-role/ class=md-nav__link> <span class=md-ellipsis> SA </span> </a> </li> <li class=md-nav__item> <a href=../../sa/saas/ class=md-nav__link> <span class=md-ellipsis> SaaS </span> </a> </li> <li class=md-nav__item> <a href=../../sa/resiliency/ class=md-nav__link> <span class=md-ellipsis> Resiliency </span> </a> </li> <li class=md-nav__item> <a href=../../templ/ class=md-nav__link> <span class=md-ellipsis> Conduct Design session </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Analytics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Analytics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../analytics/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../analytics/emr/ class=md-nav__link> <span class=md-ellipsis> EMR </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Data </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../data/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../data/rds/ class=md-nav__link> <span class=md-ellipsis> RDS-Aurora </span> </a> </li> <li class=md-nav__item> <a href=../../data/dynamodb/ class=md-nav__link> <span class=md-ellipsis> DynamoDB </span> </a> </li> <li class=md-nav__item> <a href=../../data/data-lake/ class=md-nav__link> <span class=md-ellipsis> Data Lake </span> </a> </li> <li class=md-nav__item> <a href=../../data/redshift/ class=md-nav__link> <span class=md-ellipsis> RedShift </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> AI-ML </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> AI-ML </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> <span class=md-ellipsis> All Services </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> SageMaker </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> SageMaker </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> <nav class=md-nav aria-label=Introduction> <ul class=md-nav__list> <li class=md-nav__item> <a href=#benefits class=md-nav__link> <span class=md-ellipsis> Benefits </span> </a> </li> <li class=md-nav__item> <a href=#key-term-definitions class=md-nav__link> <span class=md-ellipsis> Key Term Definitions </span> </a> </li> <li class=md-nav__item> <a href=#components class=md-nav__link> <span class=md-ellipsis> Components </span> </a> </li> <li class=md-nav__item> <a href=#pricing class=md-nav__link> <span class=md-ellipsis> Pricing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sagemaker-studio class=md-nav__link> <span class=md-ellipsis> SageMaker Studio </span> </a> <nav class=md-nav aria-label="SageMaker Studio"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#domain class=md-nav__link> <span class=md-ellipsis> Domain </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-ml-process class=md-nav__link> <span class=md-ellipsis> The ML process </span> </a> <nav class=md-nav aria-label="The ML process"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#data-wrangler class=md-nav__link> <span class=md-ellipsis> Data Wrangler </span> </a> </li> <li class=md-nav__item> <a href=#persist-to-feature-store class=md-nav__link> <span class=md-ellipsis> Persist to Feature Store </span> </a> </li> <li class=md-nav__item> <a href=#processing-job class=md-nav__link> <span class=md-ellipsis> Processing job </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#develop-with-sklearn-library-and-deploy-with-sagemaker class=md-nav__link> <span class=md-ellipsis> Develop with sklearn library and deploy with SageMaker </span> </a> </li> <li class=md-nav__item> <a href=#jumpstart class=md-nav__link> <span class=md-ellipsis> Jumpstart </span> </a> </li> <li class=md-nav__item> <a href=#deeper-dive class=md-nav__link> <span class=md-ellipsis> Deeper dive </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../bedrock/ class=md-nav__link> <span class=md-ellipsis> Bedrock </span> </a> </li> <li class=md-nav__item> <a href=../q/ class=md-nav__link> <span class=md-ellipsis> Amazon Q </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Serverless </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Serverless </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../serverless/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/lambda/ class=md-nav__link> <span class=md-ellipsis> Lambda </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/apigtw/ class=md-nav__link> <span class=md-ellipsis> API Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/ecs/ class=md-nav__link> <span class=md-ellipsis> ECS </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/eks/ class=md-nav__link> <span class=md-ellipsis> EKS </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/aws-messaging-study class=md-nav__link> <span class=md-ellipsis> Messaging </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/msk/ class=md-nav__link> <span class=md-ellipsis> MSK </span> </a> </li> <li class=md-nav__item> <a href=../../kinesis/ class=md-nav__link> <span class=md-ellipsis> Kinesis* </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/eventbridge/ class=md-nav__link> <span class=md-ellipsis> EventBridge </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/stepfct/ class=md-nav__link> <span class=md-ellipsis> Step function </span> </a> </li> <li class=md-nav__item> <a href=../../serverless/mwaa/ class=md-nav__link> <span class=md-ellipsis> MWAA </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Playground </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Playground </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../playground/ class=md-nav__link> <span class=md-ellipsis> AWS personal labs </span> </a> </li> <li class=md-nav__item> <a href=../../playground/gettingstarted/ class=md-nav__link> <span class=md-ellipsis> Getting Started EC2 </span> </a> </li> <li class=md-nav__item> <a href=../../playground/security/ class=md-nav__link> <span class=md-ellipsis> Security-IAM demos </span> </a> </li> <li class=md-nav__item> <a href=../../playground/s3-play/ class=md-nav__link> <span class=md-ellipsis> S3 play </span> </a> </li> <li class=md-nav__item> <a href=../../playground/networking/ class=md-nav__link> <span class=md-ellipsis> Networking </span> </a> </li> <li class=md-nav__item> <a href=../../playground/rds/ class=md-nav__link> <span class=md-ellipsis> RDS </span> </a> </li> <li class=md-nav__item> <a href=../../playground/rt-data-processing/ class=md-nav__link> <span class=md-ellipsis> Data processing </span> </a> </li> <li class=md-nav__item> <a href=../../playground/spark-emr/ class=md-nav__link> <span class=md-ellipsis> Analytics on EMR </span> </a> </li> <li class=md-nav__item> <a href=../../playground/ecs/ class=md-nav__link> <span class=md-ellipsis> ECS </span> </a> </li> <li class=md-nav__item> <a href=../../playground/s3-org-billing/ class=md-nav__link> <span class=md-ellipsis> S3 storage lens </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/big-data-tenant-analytics/ class=md-nav__link> <span class=md-ellipsis> SaaS demo </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Coding </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Coding </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../coding/ class=md-nav__link> <span class=md-ellipsis> Practices </span> </a> </li> <li class=md-nav__item> <a href=../../coding/sam/ class=md-nav__link> <span class=md-ellipsis> SAM </span> </a> </li> <li class=md-nav__item> <a href=../../coding/cloudFormation/ class=md-nav__link> <span class=md-ellipsis> CloudFormation </span> </a> </li> <li class=md-nav__item> <a href=../../coding/cdk/ class=md-nav__link> <span class=md-ellipsis> CDK </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io class=md-nav__link> <span class=md-ellipsis> Return to main </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> <nav class=md-nav aria-label=Introduction> <ul class=md-nav__list> <li class=md-nav__item> <a href=#benefits class=md-nav__link> <span class=md-ellipsis> Benefits </span> </a> </li> <li class=md-nav__item> <a href=#key-term-definitions class=md-nav__link> <span class=md-ellipsis> Key Term Definitions </span> </a> </li> <li class=md-nav__item> <a href=#components class=md-nav__link> <span class=md-ellipsis> Components </span> </a> </li> <li class=md-nav__item> <a href=#pricing class=md-nav__link> <span class=md-ellipsis> Pricing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sagemaker-studio class=md-nav__link> <span class=md-ellipsis> SageMaker Studio </span> </a> <nav class=md-nav aria-label="SageMaker Studio"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#domain class=md-nav__link> <span class=md-ellipsis> Domain </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-ml-process class=md-nav__link> <span class=md-ellipsis> The ML process </span> </a> <nav class=md-nav aria-label="The ML process"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#data-wrangler class=md-nav__link> <span class=md-ellipsis> Data Wrangler </span> </a> </li> <li class=md-nav__item> <a href=#persist-to-feature-store class=md-nav__link> <span class=md-ellipsis> Persist to Feature Store </span> </a> </li> <li class=md-nav__item> <a href=#processing-job class=md-nav__link> <span class=md-ellipsis> Processing job </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#develop-with-sklearn-library-and-deploy-with-sagemaker class=md-nav__link> <span class=md-ellipsis> Develop with sklearn library and deploy with SageMaker </span> </a> </li> <li class=md-nav__item> <a href=#jumpstart class=md-nav__link> <span class=md-ellipsis> Jumpstart </span> </a> </li> <li class=md-nav__item> <a href=#deeper-dive class=md-nav__link> <span class=md-ellipsis> Deeper dive </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=amazon-sagemaker><a href=https://docs.aws.amazon.com/sagemaker/latest/dg/what-is.html>Amazon SageMaker</a><a class=headerlink href=#amazon-sagemaker title="Permanent link">&para;</a></h1> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <p>Fully managed machine learning service, for developers and data scientists, to develop machine learning models then directly deploy them into a production-ready hosted environment. It includes a Feature store. It also provides an integrated Jupyter authoring notebook instance.</p> <p>The figure below explains how SageMaker works for model training, by using S3 bucket as source of data (Ground Truth), ECR Container registry to get predefined image, models are persisted in S3 bucket output folder:</p> <p><img alt src=../diagrams/sagemaker-training.drawio.png width=700></p> <p>Amazon SageMaker always uses Docker containers when running scripts, training algorithms, and deploying models. We can create a training job with the SageMaker console, AWS CLI, Python notebook, or using the SageMaker Python SDK.</p> <p>After we trained our machine learning model, we can deploy it using Amazon SageMaker deployment, using one of the following scenarios:</p> <ul> <li> <p>One prediction at a time, use real-time inference hosting service: limit to 6MB and t&lt;60s </p> <p><img alt src=../diagrams/sagemaker-hosting.drawio.png width=700></p> </li> <li> <p>Workloads that tolerate cold start can use <a href=https://docs.aws.amazon.com/sagemaker/latest/dg/serverless-endpoints.html>serverless inference</a>. Pay for only when used.</p> </li> <li>For large payload &gt; 1GB, long processing, use batch processing. </li> <li>When the request is queued, use <a href=https://docs.aws.amazon.com/sagemaker/latest/dg/async-inference.html>Asynchronous inference</a>.</li> </ul> <p>See <a href=https://docs.aws.amazon.com/sagemaker/latest/dg/deploy-model.html/#deploy-model-options>inference deployment options</a> for details.</p> <h3 id=benefits>Benefits<a class=headerlink href=#benefits title="Permanent link">&para;</a></h3> <ul> <li>Labelling raw data and active learning</li> <li>Fully managed notebook</li> <li>Models are in OCI images</li> <li><strong>Amazon SageMaker Clarify</strong> helps improve the machine learning (ML) models by detecting potential bias and by explaining the predictions that models make.</li> <li><a href=#jumpstart>SageMaker JumpStart</a> provides pretrained, open-source models for a wide range of problem types to help you get started with machine learning. For LLMs, it includes <strong>LLaMa-2-7b, BLOOM 176B, FLAN-T5 XL, or GPT-J 6B</strong>...</li> <li>Isolate team in a security domain which includes EBS, collaborative editing capabilities, computes, sharing spaces.</li> <li>Canvas is used to integrate with data source connectors, includes ready to use models and do ETL.</li> <li>Model endpoint can be called asynchronously with data from S3.</li> <li>Can use Sagemaker docker <a href=https://docs.aws.amazon.com/sagemaker/latest/dg/pre-built-containers-frameworks-deep-learning.html>image for deep learning</a> with different framework like TensorFlow, PyTorch, ...</li> </ul> <h3 id=key-term-definitions>Key Term Definitions<a class=headerlink href=#key-term-definitions title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Term</th> <th>Definition</th> </tr> </thead> <tbody> <tr> <td><strong>Inferentia</strong></td> <td>AWS custom chip which is designed for ultra-fast low cost ML inference. New library releases in Q2 2023 have made LLM compilation easier</td> </tr> <tr> <td><strong>SageMaker Distributed Training</strong></td> <td>SageMaker provides distributed training libraries and supports various distributed training options for deep learning tasks such as computer vision (CV) and natural language processing (NLP). With SageMaker’s distributed training libraries, you can run highly scalable and cost-effective custom data parallel and model parallel deep learning training jobs.</td> </tr> <tr> <td><strong>SageMaker Jumpstart Foundation Models</strong></td> <td>SageMaker JumpStart provides pretrained, open-source models for a wide range of problem types to help you get started with machine learning. You can incrementally train and tune these models before deployment. JumpStart also provides solution templates that set up infrastructure for common use cases, and executable example notebooks for machine learning with SageMaker.</td> </tr> <tr> <td><strong>Titan</strong></td> <td>A textual foundation model developed internally to Amazon. First renditions is text to text and text to vector models. These models are zero-shot instructor models and can solve tasks like summarization, question answer, language generation, and advanced search.</td> </tr> <tr> <td><strong>Trainium</strong></td> <td>AWS custom chip which is designed for ultra-fast low cost ML training and inference.</td> </tr> </tbody> </table> <h3 id=components>Components<a class=headerlink href=#components title="Permanent link">&para;</a></h3> <ul> <li><a href=https://docs.aws.amazon.com/sagemaker/latest/dg/canvas.html>Canvas</a>: generate prediction with a no-code approach. With Canvas, we can chat with popular large language models (LLMs), access Ready-to-use models, or build a custom model trained on new data. See <a href=https://docs.aws.amazon.com/sagemaker/latest/dg/canvas-getting-started.html>getting started</a>.</li> <li><a href>Autopilot</a></li> <li><a href>Governance</a></li> <li><a href>Hpyerpod Clusters</a></li> <li><a href>Ground Truth</a></li> <li><a href>Notebook</a></li> <li><a href=https://docs.aws.amazon.com/sagemaker/latest/dg/train-model.html>Training</a></li> <li><a href>Inference</a></li> <li><a href>Augmented AI</a></li> </ul> <h3 id=pricing>Pricing<a class=headerlink href=#pricing title="Permanent link">&para;</a></h3> <p><a href=https://aws.amazon.com/sagemaker/pricing/ >Pricing information</a>.</p> <h2 id=sagemaker-studio>SageMaker Studio<a class=headerlink href=#sagemaker-studio title="Permanent link">&para;</a></h2> <p>A single, web-based IDE to do all the ML development tasks. It supports the classical ML development steps of:</p> <ul> <li>Prepare Data.</li> <li>Build Model using Notebook.</li> <li>Train and tune model.</li> <li>Deploy and manage.</li> </ul> <p>To use SageMaker Studio, an administrator needs to get a Domain sets up (see steps in <a href=https://catalog.us-east-1.prod.workshops.aws/workshops/63069e26-921c-4ce1-9cc7-dd882ff62575/en-US/prerequisites/option2>SM immersion day</a>).</p> <h3 id=domain>Domain<a class=headerlink href=#domain title="Permanent link">&para;</a></h3> <p>A <a href=https://docs.aws.amazon.com/sagemaker/latest/dg/studio-entity-status.html><strong>Domain</strong></a> consists of an associated Amazon Elastic File System (Amazon EFS) volume; a list of authorized users; and a variety of security, application, security policies, S3 bucket, and Amazon Virtual Private Cloud configurations. Each user in a domain receives a personal and private home directory within the EFS for their own notebooks, Git repositories, and data files. Within a domain data scientists and developers can co-work on the same data and models.</p> <p><img alt src=../images/domain-user.png width=800></p> <p>After creating a Domain, we got a User Portal to access the environment. Members given access to Studio have a unique sign-in URL that directly opens Studio, and they sign in with their IAM Identity Center credentials (SSO).</p> <p>Once a user from Identity Service is assigned to a Domain, she/he can start Studio:</p> <p><img alt src=../images/SageMakerStudio.png width=800></p> <ul> <li> <p>A user needs to create an executable environment, for example a Data Science one, with all the needed libraries to use Jupyter notebook with AWS SDK boto3. The environment is a EC2 machine (t3.medium).</p> </li> <li> <p>We can use <a href=https://aws.amazon.com/blogs/machine-learning/use-the-aws-cdk-to-deploy-amazon-sagemaker-studio-lifecycle-configurations/ >CDK to create a Studio with scripts to perform automated tasks at setup time</a> and <a href=https://github.com/aws-samples/aws-cdk-sagemaker-studio-lifecycle-config>code repo.</a></p> </li> </ul> <details class="- info"> <summary>A <a href="https://aws.amazon.com/getting-started/hands-on/build-train-deploy-machine-learning-model-sagemaker/?ref=gsrchandson">Simple tutorial</a></summary> <p>The classical model development and deployment steps are:</p> <ol> <li>Be sure to have an IAM Role created so SageMaker Studio running in a EC2 instance can access remote AWS services, like S3...</li> <li>Inside Studio, create a SageMaker notebook instance - Use Jupyter notebook with Conda and Python3</li> <li>Prepare the data: create S3 bucket, load csv source as training data set, build train and test data sets by splitting the source data.</li> <li> <p>Train the model to learn from the data, using session to cluster hosts:</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>sagemaker</span>
<span class=c1># Use SageMaker estimator </span>
<span class=n>sess</span> <span class=o>=</span> <span class=n>sagemaker</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
<span class=n>xgb</span> <span class=o>=</span> <span class=n>sagemaker</span><span class=o>.</span><span class=n>estimator</span><span class=o>.</span><span class=n>Estimator</span><span class=p>(</span><span class=n>xgboost_container</span><span class=p>,</span> <span class=n>role</span><span class=p>,</span> <span class=n>instance_count</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> 
                <span class=n>instance_type</span><span class=o>=</span><span class=s1>&#39;ml.m4.xlarge&#39;</span><span class=p>,</span>
                <span class=n>output_path</span><span class=o>=</span><span class=s1>&#39;s3://</span><span class=si>{}</span><span class=s1>/</span><span class=si>{}</span><span class=s1>/output&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>bucket_name</span><span class=p>,</span> <span class=n>prefix</span><span class=p>),</span>
                <span class=n>sagemaker_session</span><span class=o>=</span><span class=n>sess</span><span class=p>)</span>
<span class=n>xgb</span><span class=o>.</span><span class=n>set_hyperparameters</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>eta</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>gamma</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>min_child_weight</span><span class=o>=</span><span class=mi>6</span><span class=p>,</span> <span class=n>subsample</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>silent</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
            <span class=n>objective</span><span class=o>=</span><span class=s1>&#39;binary:logistic&#39;</span><span class=p>,</span> <span class=n>num_round</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>
<span class=c1># fit on the training set</span>
<span class=n>xgb</span><span class=o>.</span><span class=n>fit</span><span class=p>({</span><span class=s1>&#39;train&#39;</span><span class=p>:</span> <span class=n>s3_input_train</span><span class=p>})</span>
</code></pre></div> </li> <li> <p>Deploy the model:</p> <div class=highlight><pre><span></span><code><span class=n>xgb_predictor</span> <span class=o>=</span> <span class=n>xgb</span><span class=o>.</span><span class=n>deploy</span><span class=p>(</span><span class=n>initial_instance_count</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span><span class=n>instance_type</span><span class=o>=</span><span class=s1>&#39;ml.m4.xlarge&#39;</span><span class=p>)</span>
</code></pre></div> </li> <li> <p>Evaluate a ML model's performance</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>sagemaker.serializers</span> <span class=kn>import</span> <span class=n>CSVSerializer</span>

<span class=n>test_data_array</span> <span class=o>=</span> <span class=n>test_data</span><span class=o>.</span><span class=n>drop</span><span class=p>([</span><span class=s1>&#39;y_no&#39;</span><span class=p>,</span> <span class=s1>&#39;y_yes&#39;</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>values</span> <span class=c1>#load the data into an array</span>
<span class=n>xgb_predictor</span><span class=o>.</span><span class=n>serializer</span> <span class=o>=</span> <span class=n>CSVSerializer</span><span class=p>()</span> <span class=c1># set the serializer type</span>
<span class=n>predictions</span> <span class=o>=</span> <span class=n>xgb_predictor</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>test_data_array</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=c1># predict!</span>
<span class=n>predictions_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>fromstring</span><span class=p>(</span><span class=n>predictions</span><span class=p>[</span><span class=mi>1</span><span class=p>:],</span> <span class=n>sep</span><span class=o>=</span><span class=s1>&#39;,&#39;</span><span class=p>)</span> <span class=c1># and turn the prediction into an array</span>
<span class=nb>print</span><span class=p>(</span><span class=n>predictions_array</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</code></pre></div> <p>It generates a confusion matrix like:</p> <div class=highlight><pre><span></span><code>Overall<span class=w> </span>Classification<span class=w> </span>Rate:<span class=w> </span><span class=m>89</span>.5%

Predicted<span class=w>      </span>No<span class=w> </span>Purchase<span class=w>    </span>Purchase
Observed
No<span class=w> </span>Purchase<span class=w>    </span><span class=m>90</span>%<span class=w> </span><span class=o>(</span><span class=m>10769</span><span class=o>)</span><span class=w>    </span><span class=m>37</span>%<span class=w> </span><span class=o>(</span><span class=m>167</span><span class=o>)</span>
Purchase<span class=w>        </span><span class=m>10</span>%<span class=w> </span><span class=o>(</span><span class=m>1133</span><span class=o>)</span><span class=w>     </span><span class=m>63</span>%<span class=w> </span><span class=o>(</span><span class=m>288</span><span class=o>)</span><span class=w> </span>
</code></pre></div> </li> </ol> </details> <h2 id=the-ml-process>The ML process<a class=headerlink href=#the-ml-process title="Permanent link">&para;</a></h2> <p>The following figure illustrates the classical Machine Learning process:</p> <p><img alt src=https://static.us-east-1.prod.workshops.aws/public/b47fa3b3-57fd-4ef6-8a3c-b5b24d8db469/static/lab1/image2.png width=800></p> <h3 id=data-wrangler>Data Wrangler<a class=headerlink href=#data-wrangler title="Permanent link">&para;</a></h3> <p>Data Wrangler (File &gt; New &gt; Data Wrangler Flow) is a tool to help do feature engineering, and build data workflow.</p> <ul> <li> <p>From defining connection to data source, and import dataset:</p> <p><img alt src=../images/wrangler-1.png width=900></p> </li> <li> <p>Add a Data Analysis to the data flow, using Data Quality and Insights Report: </p> <p><img alt src=../images/SM-data-analysis.png width=900></p> </li> <li> <p>Or add one to assess the correlation between one variable and the output, using a data analysis based on Histogram:</p> <p><img alt src=../images/age-analysis.png width=900></p> </li> <li> <p>Adding table summary to the flow to get means, min, max... per column.</p> </li> <li> <p>We can also add Bias for the marital status to y:</p> <p><img alt src=../images/bias-marital.png width=900></p> <p>We observe a class imbalance where the married class is 21% more represented than other classes. We also observe that the married class is 2.8% less likely to subscribe to a bank term deposit</p> </li> <li> <p>We can find out Target Leakage which occurs when there is data in a machine learning training dataset that is strongly correlated with the target label, but is not available in real-world data.</p> <p><img alt src=../images/target-leakage.png width=900></p> </li> <li> <p>We can add more analysis like histograms, or add a predifined transformation, like Synthetic Minority Over-sampling Technique (<a href=https://en.wikipedia.org/wiki/Oversampling_and_undersampling_in_data_analysis>SMOTE</a>):</p> <p><img alt src=../images/smote-a.png width=900></p> </li> <li> <p>Remove any outliers using Standard deviation at 3 sigma.</p> <p><img alt src=../images/outliers.png width=900></p> </li> <li> <p>Scale the numerical features, using min-max scaler from 0 to 1.</p> </li> <li> <p>Replace feature characters to replace '.' to '_' for categorical features.</p> <p><img alt src=../images/edit-string.png width=900></p> </li> <li> <p>Finally we can add custom transform in Python (user-defined function), Python Pandas, PySpark, like compute variance_inflation_factor for numerical features and drop columns with vif &gt; 1.2</p> </li> <li> <p>Do one_hot_encoding transformation for categorical data, choose all string type columns as Input columns and select Columns as Output style.</p> <p><img alt src=../images/data-encode.png width=900></p> </li> </ul> <h3 id=persist-to-feature-store>Persist to Feature Store<a class=headerlink href=#persist-to-feature-store title="Permanent link">&para;</a></h3> <p>We can also use the SageMaker Feature Store as a centralized storage for all the features potentially created by multiple teams and that can then also be retrieved consumed by multiple teams. The access is not obvious (Use + on last tranformation and menu &gt; Add destination &gt; Feature Store), start by defining a feature group:</p> <p><img alt src=../images/feature-store.png width=900></p> <p>The feature store can be online (used for real time inference) or offline (for batch training). Offline is a S3 bucket. The JSON schema helps to validate the data set.</p> <h3 id=processing-job>Processing job<a class=headerlink href=#processing-job title="Permanent link">&para;</a></h3> <p>To do the data wrangler, SageMaker can start batch processing job using Apache Sparks.</p> <p><img alt src=../images/SM-create-job.png width=900></p> <p>The trained parameters have been fitted on the available data in Data Wrangler with certain transforms including One-hot encode, Scale values and Standard deviation numeric outliers. These transforms depend on the available data and must be re-fitted when new data is available.</p> <p>We can schedule the job to run at certain time of the day, from different input file.</p> <p>The outcome of the batch processing job will be a set of parquet files with the processed data saved in the 'off-line store', a flow definition, and spark configuration files.</p> <h2 id=develop-with-sklearn-library-and-deploy-with-sagemaker>Develop with sklearn library and deploy with SageMaker<a class=headerlink href=#develop-with-sklearn-library-and-deploy-with-sagemaker title="Permanent link">&para;</a></h2> <p>A typical training script loads data from the input channels, configures training with hyperparameters, trains a model, and saves a model to model_dir so that it can be hosted later</p> <ul> <li><a href=https://sagemaker.readthedocs.io/en/stable/frameworks/sklearn/using_sklearn.html#deploy-a-scikit-learn-model>See the tutorial: Using SKLearn with SageMaker</a> and a code to compute a RandomForest for a SaaS company assessing the risk of their customers to churn <a href=https://github.com/jbcodeforce/big-data-tenant-analytics/tree/main/CompanyRisk>big-data-tenant-analytics &gt; CompanyRisk</a>.</li> <li><a href=https://sagemaker.readthedocs.io/en/stable/overview.html#using-the-sagemaker-python-sdk>See also: Using the SageMaker Python SDK</a>: SageMaker Python SDK provides several high-level abstractions for working with Amazon SageMaker.</li> </ul> <p>Scripts, training and test data sets are in s3. The SDK helps to access SageMaker constructs and deploy the model as a service with reachable endpoint. The endpoint runs a SageMaker-provided Scikit-learn model server and hosts the model produced by our training script.</p> <p>As SageMaker Pythin SDK uses a Docker image to create sklearn environment we can define our own image with our custom libraries via a <code>requirements.txt</code>.</p> <p>We run Scikit-learn training scripts on SageMaker by creating SKLearn Estimators.</p> <h2 id=jumpstart>Jumpstart<a class=headerlink href=#jumpstart title="Permanent link">&para;</a></h2> <p><a href=https://docs.aws.amazon.com/sagemaker/latest/dg/studio-jumpstart.html>Amazon SageMaker JumpStart</a> provides a set of foundation models, build-in algorithms and prebuilt ML solutions for common use cases that can be deployed readily in just a few steps. JumpStart is a ML hub with 400+ built-in algorithms with pre-trained models including foundation models. The price is based on the resources used.</p> <p>Consider Jumpstart when:</p> <ul> <li>The best LLM for the task is not in Bedrock</li> <li>The size of requests and/or request frequency of the use case makes Jumpstart more cost effective — Paying by the hour instead of the token.</li> <li>The terms and conditions of Bedrock models don’t meet the use case.</li> <li>Using JumpStart, we can perform inference on a pre-trained model, even without fine-tuning it first on a custom dataset. We can also fine tune a model on specific dataset.</li> <li>Deploying a model, differs by model and instance availability of the required instance type.</li> </ul> <details class="- example"> <summary>Generate text with Prompt only approach</summary> <p>The following code can be integrated into a Jupyter Notebook: it uses Google Flan T5 LLM, with dialog data sets from Hugging Face, transformers tokenizer, and a prompt to expect a summarization of the conversation between two humans:</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>transformers</span> <span class=kn>import</span> <span class=n>AutoTokenizer</span>
<span class=kn>from</span> <span class=nn>transformers</span> <span class=kn>import</span> <span class=n>AutoModelForSeq2SeqLM</span>
<span class=kn>from</span> <span class=nn>datasets</span> <span class=kn>import</span> <span class=n>load_dataset</span>
<span class=c1># Load a dialog data sets from Hugging Face</span>
<span class=n>huggingface_dataset_name</span> <span class=o>=</span> <span class=s2>&quot;knkarthick/dialogsum&quot;</span>
<span class=n>dataset</span> <span class=o>=</span> <span class=n>load_dataset</span><span class=p>(</span><span class=n>huggingface_dataset_name</span><span class=p>)</span>

<span class=n>model_checkpoint</span><span class=o>=</span><span class=s1>&#39;google/flan-t5-base&#39;</span>

<span class=n>tokenizer</span> <span class=o>=</span> <span class=n>AutoTokenizer</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span><span class=n>model_checkpoint</span><span class=p>,</span> <span class=n>use_fast</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=c1># Instantiate one of the model classes of the library (with a sequence-to-sequence language modeling head) from a pretrained model.</span>
<span class=c1># Sequence-to-sequence models are best suited for tasks revolving around generating new sentences depending on a given input, such as summarization, translation, or generative question answering</span>
<span class=n>model</span> <span class=o>=</span> <span class=n>AutoModelForSeq2SeqLM</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span><span class=n>model_checkpoint</span><span class=p>)</span>

<span class=n>start_prompt</span> <span class=o>=</span> <span class=s1>&#39;Summarize the following conversation.</span><span class=se>\n</span><span class=s1>&#39;</span>
<span class=n>end_prompt</span> <span class=o>=</span> <span class=s1>&#39;</span><span class=se>\n\n</span><span class=s1>Summary: &#39;</span>
<span class=n>dialogue</span> <span class=o>=</span> <span class=n>dataset</span><span class=p>[</span><span class=s1>&#39;test&#39;</span><span class=p>][</span><span class=n>example_indices</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=s1>&#39;dialogue&#39;</span><span class=p>]</span>
<span class=n>summary</span> <span class=o>=</span> <span class=n>dataset</span><span class=p>[</span><span class=s1>&#39;test&#39;</span><span class=p>][</span><span class=n>example_indices</span><span class=p>[</span><span class=mi>0</span><span class=p>]][</span><span class=s1>&#39;summary&#39;</span><span class=p>]</span>
<span class=n>prompt</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>start_prompt</span><span class=si>}{</span><span class=n>dialogue</span><span class=si>}{</span><span class=n>end_prompt</span><span class=si>}</span><span class=s1>&#39;</span>

<span class=n>inputs</span> <span class=o>=</span> <span class=n>tokenizer</span><span class=p>(</span><span class=n>prompt</span><span class=p>,</span> <span class=n>return_tensors</span><span class=o>=</span><span class=s1>&#39;pt&#39;</span><span class=p>)</span>
<span class=n>output</span> <span class=o>=</span> <span class=n>tokenizer</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span>
    <span class=n>model</span><span class=o>.</span><span class=n>generate</span><span class=p>(</span>
        <span class=n>inputs</span><span class=p>[</span><span class=s2>&quot;input_ids&quot;</span><span class=p>],</span> 
        <span class=n>max_new_tokens</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
    <span class=p>)[</span><span class=mi>0</span><span class=p>],</span> 
    <span class=n>skip_special_tokens</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;INPUT PROMPT:</span><span class=se>\n</span><span class=si>{</span><span class=n>prompt</span><span class=si>}</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;MODEL GENERATION:</span><span class=se>\n</span><span class=si>{</span><span class=n>output</span><span class=si>}</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;BASELINE SUMMARY:</span><span class=se>\n</span><span class=si>{</span><span class=n>summary</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</code></pre></div> </details> <h2 id=deeper-dive>Deeper dive<a class=headerlink href=#deeper-dive title="Permanent link">&para;</a></h2> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> <a href=https://docs.aws.amazon.com/sagemaker/latest/dg/onboard-sso-users.html>Onboard to Amazon SageMaker Domain Using IAM Identity Center</a> to define user in IAM-IC and then use Domain in SageMaker to authorize users to login via SSO.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> <a href=https://learn.acloud.guru/handson/1a4b7e56-0177-40a3-b03b-d6fb4457b092>Labs: Creating a scikit-learn Random Forest Classifier in AWS SageMaker</a>. Applied to company risk to churn demo in <a href=https://github.com/jbcodeforce/big-data-tenant-analytics/tree/main/CompanyRisk>this folder</a>.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <a href=https://sagemaker.readthedocs.io/en/stable/overview.html#using-the-sagemaker-python-sdk>Using the SageMaker Python SDK</a>.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <a href=https://github.com/aws/amazon-sagemaker-examples/blob/main/sagemaker-python-sdk/ >Examples of using SageMaker Python SDK</a>.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <a href=https://github.com/awslabs/amazon-sagemaker-workshop>Amazon SageMaker Workshops</a></li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <a href=https://catalog.us-east-1.prod.workshops.aws/workshops/63069e26-921c-4ce1-9cc7-dd882ff62575/en-US>SageMaker Immersion Day</a></li> <li><a href=https://github.com/aws/amazon-sagemaker-examples>gitHub Amazon SageMaker Examples</a> including Inference Recommender.</li> <li><a href=https://github.com/aws/amazon-sagemaker-examples/blob/main/sagemaker_processing/scikit_learn_data_processing_and_model_evaluation/scikit_learn_data_processing_and_model_evaluation.ipynb>scikit_learn_data_processing_and_model_evaluation</a></li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> <a href=https://aws.amazon.com/getting-started/hands-on/machine-learning-tutorial-set-up-sagemaker-studio-account-permissions/ >Add permissions to a Amazon SageMaker Studio account</a> when we need to enable access from Studio to SageMakerAPI using the IAM policies <code>AmazonSageMakerFullAccess</code> and <code>AWSCloudFormationFullAccess</code>. The lab is little bit old, so now in SageMaker we need to access users via Domain.</li> <li><a href=https://aws.amazon.com/blogs/machine-learning/mlops-deployment-best-practices-for-real-time-inference-model-serving-endpoints-with-amazon-sagemaker/ >MLOps deployment best practices for real-time inference model serving endpoints with Amazon SageMaker</a>.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <a href=https://catalog.us-east-1.prod.workshops.aws/workshops/f772b430-37d0-4adc-ba65-2f3e229caa5c/en-US>Generative AI and Data Science on AWS</a>.</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> <a href=https://catalog.us-east-1.prod.workshops.aws/workshops/972fd252-36e5-4eed-8608-743e84957f8e/en-US>Generative AI on Amazon SageMaker - Workshop</a>: addresses SageMaker Quickstart solutions for text-text and text-image models, prompt engineering, fine-tuning Llama2, genAI use cases, coding Llama2.</li> <li><a href=https://gitlab.aws.dev/ai-ml-specialist-sa/amer-aiml-sa/us-west/bedrock-samples/-/tree/main/samples/personalize-plus-bedrock>Personalized Movie Tag-Line Recommendations using Amazon Bedrock and Amazon Personalize</a>.</li> </ul> <p>Please ensure that the role "arn:aws:iam::4...:role/service-role/AmazonSageMaker-ExecutionRole-20221207T113525" exists and that its trust relationship policy allows the action "sts:AssumeRole" for the service principal "sagemaker.amazonaws.com". Also ensure that the role has "s3:GetObject" permissions and that the object is located in us-west-2.</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ class="md-footer__link md-footer__link--prev" aria-label="Previous: All Services"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> All Services </div> </div> </a> <a href=../bedrock/ class="md-footer__link md-footer__link--next" aria-label="Next: Bedrock"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Bedrock </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "navigation.instant", "navigation.tracking", "navigation.footer", "navigation.tabs.sticky"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.af256bd8.min.js></script> </body> </html>